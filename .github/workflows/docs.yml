name: 'Generate Docs'
run-name: '${{ github.workflow }} for ${{ github.ref_name }}'

on: 
  push:
    branches:
      - '**-docs'
      - 'Automation'

permissions:
  contents: write
  pages: write

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  generate-docs:
    runs-on: ubuntu-latest
    steps:
      - name: Add SSH key
        env:
            SSH_AUTH_SOCK: /tmp/ssh_agent.sock
        run: |
            mkdir -p /home/runner/.ssh
            # Replace example.com with the hostname of the machine
            # you're SSH-ing into
            # ssh-keyscan example.com >> /home/runner/.ssh/known_hosts
            echo "${{ secrets.AUTOMATION_PRIVATE_KEY }}" > /home/runner/.ssh/github_actions
            chmod 600 /home/runner/.ssh/github_actions
            ssh-agent -a $SSH_AUTH_SOCK > /dev/null	
            ssh-add /home/runner/.ssh/github_actions

      - name: Configure GitHub
        env:
            SSH_AUTH_SOCK: /tmp/ssh_agent.sock
        run: |
            git config --global user.email "milo.wical@gmail.com"
            git config --global user.name "J.A.R.V.I.S. [GitHub Actions]"

      - name: Checkout
        uses: actions/checkout@v3